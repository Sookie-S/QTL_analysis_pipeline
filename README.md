QTL analysis pipeline for hybrid species from Multipool outputs.

For more information, please contact soukaina.timouma@manchester.ac.uk

This pipeline aims to detect QTL regions from LOD scores of positions (bin size of 100 bp in the example provided) and identifies the genes that overlap with each QTL regions. 
The pipeline also detects whether they are within the LOD support interval (the interval in which the LOD score is within some value of its maximum). 

------------------------------------------------------------------------

Content Description:
There are initially 2 folders (Files and Scripts) in the in the root directory. 
For example here, the root folder is 'Sookie-S/'.
A Results folder will be automatically created by the pipeline.

Please find below a description of the content of each folder:

- "Files" folder:

	- It contains folders for each conditions tested (folder "test" in the example provided).Each condition folder has two sub-folders for each parental species ("MPresults_scer" and "MPresults_skud" in the example provided). These two folders contain the LOD measured in each chromosome (.out files). These ".out" files are the output of Multipool tool that performs multi-locus genetic mapping with pooled sequencing (https://github.com/matted-zz/multipool, http://cgs.csail.mit.edu/multipool/).

	- There is also a 'Genomes' folder that contains a folder called GFF_files where you need to store the annotation of parent 1 and parent 2 ("YPS128.all_feature.gff" and "skud_updated.gff" in the example provided).

- "Scripts" folder:

	- It contains all the scripts for this analysis

- "Results" folder (that will be generated by the pipeline):

	- it will contain a folder "QTL_regions" with sub-folders for each condition tested ("test" in the example provided), that will contain the QTL regions detected (.csv files).

	- it will contain a folder "Gene_overlap" with sub-folders for each condition tested ("test" in the example provided), and will give as information the genes that are within each QTL regions detected, and if they are within the LOD support interval (.csv files).

------------------------------------------------------------------------

Step 1- Put the input files (.out files from Multipool) for parent1 and parent2 in two separated folders, that contains identifiable names for each parent ("scer" and "skud" in the example provided).
Make sure that there is only the two folders containing the .out files, the folders for parent1 and for parent2.

------------------------------------------------------------------------

For example, for the hybrid S. cerevisiae/S. kudriavzevii, the parent1 ID is "scer" and parent2 ID is "skud", so the names of the folders could be:
- "Updated_Results_lowtemp_skud_250222" and "Updated_Results_lowtemp_scer_250222"
or
- "MPresults_scer" and "MPresults_skud"
or
- "WhateverBLAscer" and "WhateverBLAskud"

------------------------------------------------------------------------

Step 2- Rename if needed the .out files to follow this nomenclature: "PREFIX_CHR.out". 

------------------------------------------------------------------------

The prefix "PREFIX" can be named anything as long as it doesn't contain an "_".
The suffix "CHR" corresponds to the chromosome name as written in the GFF file.

For example, for the hybrid S. cerevisiae/S. kudriavzevii:
The scer chromosomes "CHR" should be named chrI, chrII, chrIII etc, as it is the way they are named the S. cerevisiae GFF file provided in the example.
The skud chromosomes "CHR" should be named Skud_1, Skud_2, Skud_3 etc, as it is the way they are named the S. kudriavzevii GFF file provided in the example.

For example:
  Valid naming of the output files can be:
   - scerLT_chrI.out
   - skudLT_Skud_1.out
   - whatever_chrI.out
   - whatever_Skud_1.out
  Invalid naming (TO NOT DO, it's impertative there is no "_" in the PREFIX):
   - scer_LT_chrI.out ("scer_LT" is wrong as this prefix contain "_")
   - skidLT_lowtemp_bla_bli_blu_Skud_1.out ("skidLT_lowtemp_bla_bli_blu" is wrong as this prefix contain "_")
   - scer_chr1.out ("chr1" is wrong as the suffix doesn't match the naming in the GFF file, it should be written "chrI")
   - skidLT_Skud1.out ("Skud1" is wrong as the suffix doesn't match the naming in the GFF file, it should be written "Skud_1")

------------------------------------------------------------------------

Step 3- Launch the pipeline (from the script folder directory)

------------------------------------------------------------------------

To launch the pipeline, please specify all the following arguments:

./pipeline.sh [LOD_threshold] [LOD_support_interval] [conditionName] [Name_Parent1] [Name_parent2] [ChromosomePrefix_Parent1] [GFF_file_Name_Parent1] [ChromosomePrefix_Parent2] [GFF_file_Name_Parent2]

For example, using the data provided in the Files directory, it would be:
- LOD_threshold = 5
- LOD_support_interval = 1
- conditionName = test
- Name_Parent1 = scer
- Name_parent2 = skud
- ChromosomePrefix_Parent1 = chr
- GFF_file_Name_Parent1 = YPS128.all_feature.gff
- ChromosomePrefix_Parent2 = Skud
- GFF_file_Name_Parent2 = skud_updated.gff

The pipeline is launced by running from the Scripts directory:
./pipeline.sh 5 1 test scer skud chr YPS128.all_feature.gff Skud skud_updated.gff
